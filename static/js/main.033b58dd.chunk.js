(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{222:function(e,t,a){},224:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(62),o=a.n(s),c=(a(76),a(30)),i=a(9),l=a.n(i),u=a(68),h=a(39),p=a(18),d=a(63),m=a(64),b=a(67),f=a(65),g=a(69),w=a(19),y=a(70);function v(e){return k.apply(this,arguments)}function k(){return(k=Object(p.a)(l.a.mark(function e(t){var a,n,r,s,o,c,i,u,h;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.domain,n=t.owner,r=t.name,s=t.apiKey,o=t.after,e.next=3,fetch("https://api.".concat(a,"/graphql"),{method:"post",headers:{Authorization:"Basic ".concat(window.btoa(s))},body:JSON.stringify({query:"query($owner: String!, $name: String!, $after: String) {\n        repository(owner: $owner, name: $name, ) {\n          labels(first: 100, after: $after) {\n            pageInfo {\n              hasNextPage\n              startCursor\n            }\n            nodes {\n              name\n              color\n              issues(states: OPEN) {\n                totalCount\n              }\n            }\n          }\n        }\n      }",variables:{owner:n,name:r,after:o}})}).then(function(e){return e.ok?e.json():Promise.reject(e)}).then(function(e){return e.errors?Promise.reject(e.errors):e.data});case 3:if(c=e.sent,i=c.repository.labels,u=i.nodes,(h=i.pageInfo).hasPreviousPage){e.next=7;break}return e.abrupt("return",u);case 7:return e.t0=u,e.next=10,v(Object(y.a)({},t,{after:h.endCursor}));case 10:return e.t1=e.sent,e.abrupt("return",e.t0.concat.call(e.t0,e.t1));case 12:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function C(e){return L.apply(this,arguments)}function L(){return(L=Object(p.a)(l.a.mark(function e(t){var a,n,r,s,o,i,u,h,p;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.domain,n=t.owner,r=t.name,s=t.apiKey,e.next=3,fetch("https://api.".concat(a,"/graphql"),{method:"post",headers:{Authorization:"Basic ".concat(window.btoa(s))},body:JSON.stringify({query:"query($owner: String!, $name: String!) {\n        repository(owner: $owner, name: $name, ) {\n          issues {\n            totalCount\n          }\n          pullRequests {\n            totalCount\n          }\n        }\n      }",variables:{owner:n,name:r}})}).then(function(e){return e.ok?e.json():Promise.reject(e)}).then(function(e){return e.errors?Promise.reject(e.errors):e.data}).then(function(e){var t=e.repository;return t.issues.totalCount+t.pullRequests.totalCount});case 3:return o=e.sent,i=Math.ceil(o/100),u=Object(c.a)(Array(i).keys()).map(function(e){return e+1}),e.next=8,Promise.all(u.map(function(e){return fetch("https://api.".concat(a,"/repos/").concat(n,"/").concat(r,"/issues?state=all&direction=asc&per_page=100&page=").concat(e),{headers:{Authorization:"Basic ".concat(window.btoa(s))}}).then(function(e){return e.ok?e.json():Promise.reject(e)}).then(function(e){return e.filter(function(e){return!e.pull_request})})}));case 8:return h=e.sent,p=h.reduce(function(e,t){return e.concat(t)}),e.abrupt("return",p.map(function(e){return{title:e.title,number:e.number,createdAt:e.created_at,closedAt:e.closed_at,labels:e.labels.map(function(e){return e.name})}}));case 11:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}a(222);var x=w.a.controllers.line;w.a.controllers.line=w.a.controllers.line.extend({draw:function(e){if(x.prototype.draw.call(this,e),this.chart.tooltip._active&&this.chart.tooltip._active.length){var t=this.chart.tooltip._active[0],a=this.chart.ctx,n=t.tooltipPosition().x,r=this.chart.scales["y-axis-0"].top,s=this.chart.scales["y-axis-0"].bottom;a.save(),a.beginPath(),a.moveTo(n,r),a.lineTo(n,s),a.lineWidth=2,a.strokeStyle="#07C",a.stroke(),a.restore()}}});var E=function(e){function t(){var e,a;Object(d.a)(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return(a=Object(b.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).state={repoURL:window.localStorage.getItem("repo_url")||"",apiKey:window.localStorage.getItem("api_key")||"",numOpenIssues:null,chartLabels:null,selectedLabels:[],isCheckboxChecked:!1,isLoading:!1,errorMessage:null},a.handleRepoURLChange=function(e){a.setState({repoURL:e.target.value})},a.handleApiKeyChange=function(e){a.setState({apiKey:e.target.value})},a.handleLabelChange=function(e){var t=a.state.selectedLabels.includes(e.target.value)?a.state.selectedLabels.filter(function(t){return t!==e.target.value}):a.state.selectedLabels.concat(e.target.value);a.setState({selectedLabels:t})},a.handleCheckboxChange=function(e){a.setState({isCheckboxChecked:e.target.checked})},a.getIssues=Object(p.a)(l.a.mark(function e(){var t,n,r,s,o,c,i,p,d,m,b,f,g;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.setState({isLoading:!0,errorMessage:null}),t=a.state.repoURL.match(/(github[^\/]*)\/([^\/]*)\/([^\/&?]*)/)){e.next=4;break}return e.abrupt("return",a.setState({errorMessage:"Could not read URL. Double check the repository URL."}));case 4:return n=Object(h.a)(t,4),r=n[0],s=n[1],o=n[2],c=n[3],i={domain:s,owner:o,name:c,apiKey:a.state.apiKey},e.prev=6,e.next=9,Promise.all([v(i),C(i)]);case 9:p=e.sent,d=Object(h.a)(p,2),a.labels=d[0],a.issues=d[1],e.next=20;break;case 15:return e.prev=15,e.t0=e.catch(6),m="Failed to fetch issues",e.t0.status&&e.t0.statusText?m+=": ".concat(e.t0.status," ").concat(e.t0.statusText,". Double check your API key."):e.t0[0]&&e.t0[0].message?m+=": ".concat(e.t0[0].message):m+=". Double check the repo URL and API key.",e.abrupt("return",a.setState({errorMessage:m}));case 20:b={},a.labels.forEach(function(e){var t=e.name,a=Object(u.a)(e,["name"]);b[t]=a}),a.labels=b,f={},g=0,a.issues.forEach(function(e){var t=function(e){return new Date(new Date(e).toDateString()).toISOString()};f[t(e.createdAt)]=null,e.closedAt?f[t(e.closedAt)]=null:g+=1}),a.times=Object.keys(f).concat((new Date).toISOString()),a.times.sort(function(e,t){return new Date(e)-new Date(t)}),a.labels.__total={color:"0366d6",issues:{totalCount:g}},a.chartData={},a.setState({isLoading:!1,numOpenIssues:g,repoURL:"https://".concat(r),chartLabels:Object.keys(a.labels).sort(function(e,t){return e.localeCompare(t)}),selectedLabels:["__total"]},function(){window.localStorage.setItem("repo_url",a.state.repoURL),window.localStorage.setItem("api_key",a.state.apiKey)});case 31:case"end":return e.stop()}},e,this,[[6,15]])})),a.getChartData=function(){return a.state.isCheckboxChecked?{labels:a.times,datasets:[{label:a.state.selectedLabels.join(", "),fill:!1,borderColor:"#0366d6",lineTension:0,pointRadius:0,pointHoverRadius:0,data:a.state.selectedLabels.length?a.times.map(function(e){return a.issues.filter(function(t){return!(new Date(e)<new Date(t.createdAt))&&(!(t.closedAt&&new Date(e)>=new Date(t.closedAt))&&a.state.selectedLabels.every(function(e){return t.labels.some(function(t){return t===e})}))}).length}):[]}]}:(a.state.selectedLabels.filter(function(e){return!a.chartData[e]}).forEach(function(e){a.chartData[e]=a.times.map(function(t){return a.issues.filter(function(a){return!(new Date(t)<new Date(a.createdAt))&&(!(a.closedAt&&new Date(t)>=new Date(a.closedAt))&&("__total"===e||a.labels.some(function(t){return t===e})))}).length})}),{labels:a.times,datasets:a.state.selectedLabels.map(function(e){return{label:e,data:Object(c.a)(a.chartData[e]),borderColor:"#".concat(a.labels[e].color),fill:!1,lineTension:0,pointRadius:0,pointHoverRadius:0}})})},a.renderChartArea=function(){return a.state.isLoading||a.state.chartLabels?a.state.isLoading||!a.state.chartLabels?r.a.createElement("div",{className:"status"},"Loading..."):r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"status"},"There are ",a.state.numOpenIssues," open issues"),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"chart"},r.a.createElement(w.b,{data:a.getChartData(),options:{legend:{display:!1},tooltips:{intersect:!1,mode:"index"},scales:{xAxes:[{type:"time",time:{tooltipFormat:"ll"}}]}}})),r.a.createElement("div",{className:"labels"},r.a.createElement("h2",null,"Labels"),r.a.createElement("input",{type:"checkbox",checked:a.state.isCheckboxChecked,onChange:a.handleCheckboxChange}),"Use AND Filter",a.state.chartLabels.map(function(e){return r.a.createElement("option",{className:a.state.selectedLabels.includes(e)?"selected":null,key:e,value:e,onClick:a.handleLabelChange},e," (",a.labels[e].issues.totalCount,")")})))):r.a.createElement("div",{className:"status"},r.a.createElement("span",null,"Enter your "),r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://help.github.com/articles/creating-a-personal-access-token-for-the-command-line/"},"GitHub token"),r.a.createElement("span",null,' with the "repo" scope to get started.'))},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"repo-info"},r.a.createElement("input",{value:this.state.repoURL,onChange:this.handleRepoURLChange,placeholder:"Repo URL"}),r.a.createElement("input",{value:this.state.apiKey,onChange:this.handleApiKeyChange,placeholder:"API Key"}),r.a.createElement("button",{onClick:this.getIssues},"Submit")),this.state.errorMessage?r.a.createElement("div",{className:"error"},this.state.errorMessage):this.renderChartArea())}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},71:function(e,t,a){e.exports=a(224)},76:function(e,t,a){}},[[71,2,1]]]);
//# sourceMappingURL=main.033b58dd.chunk.js.map